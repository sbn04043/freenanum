<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title>Chat</title>
    <link th:href="@{/css/styles.css}" rel="stylesheet"/>
</head>
<body>
<!-- Navigation-->
<div th:replace="~{/fragment/header :: header}"></div>
<div class="container">
    <h1 class="my-4">ì±„íŒ…</h1>
    <div class="chat-container">
        <!-- ì™¼ìª½: ëŒ€í™” ìƒëŒ€ ë¦¬ìŠ¤íŠ¸ -->
        <div class="user-list">
            <h5 class="p-3">ëŒ€í™” ìƒëŒ€</h5>
            <div class="user-item" onclick="selectUser('User 1')">
                <img src="/images/profile/userDefaultImg.png" alt="User 1" class="profile-image">
                User 1
            </div>
            <div class="user-item" onclick="selectUser('User 2')">
                <img src="/images/profile/userDefaultImg.png" alt="User 1" class="profile-image">
                User 2
            </div>
            <div class="user-item" onclick="selectUser('User 3')">
                <img src="/images/profile/userDefaultImg.png" alt="User 1" class="profile-image">
                User 3
            </div>
        </div>
        <!-- ì˜¤ë¥¸ìª½: í˜„ì¬ ëŒ€í™” ì¤‘ì¸ ìƒëŒ€ì™€ì˜ ì±„íŒ… ê¸°ë¡ -->
        <div class="chat-box">
            <h5 id="current-user">User 1ê³¼ì˜ ëŒ€í™”</h5>
            <div class="messages">
                <div class="message-container other">
                    <div class="message other">ì•ˆë…•í•˜ì„¸ìš”!</div>
                    <div class="message-time">ì˜¤ì „ 10:00</div>
                </div>
                <div class="message-container user">
                    <div class="message user">ì•ˆë…•í•˜ì„¸ìš”! ì–´ë–»ê²Œ ë„ì™€ë“œë¦´ê¹Œìš”?</div>
                    <div class="message-time">ì˜¤ì „ 10:01</div>
                </div>
                <div class="message-container other">
                    <div class="message other">ì œí’ˆì— ëŒ€í•´ ë¬¸ì˜í•˜ê³  ì‹¶ì–´ìš”.</div>
                    <div class="message-time">ì˜¤ì „ 10:02</div>
                </div>
            </div>

            <!-- Fixed input box inside chat-box -->
            <div class="input-group mt-3">
                <div class="input-group-prepend">
                    <button class="btn btn-outline-secondary" type="button" id="attachButton">
                        ğŸ“
                    </button>
                </div>
                <input type="file" id="fileInput" style="display: none;">
                <input type="text" class="form-control" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." id="chatInput">
                <div class="input-group-append">
                    <button class="btn btn-primary" onclick="sendMessage()">ì „ì†¡</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Footer-->
<div th:replace="~{/fragment/footer :: footer}"></div>
<script>
    function selectUser(userName) {
        document.getElementById('current-user').innerText = userName + 'ê³¼ì˜ ëŒ€í™”';
        // ì—¬ê¸°ì— í•´ë‹¹ ìœ ì €ì˜ ì±„íŒ… ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë¡œì§ ì¶”ê°€
    }

    function sendMessage() {
        const message = document.getElementById('chatInput').value;
        const time = new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' });

        if (message) {
            const messagesContainer = document.querySelector('.messages');
            const newMessageContainer = document.createElement('div');
            newMessageContainer.className = 'message-container user';

            const newMessage = document.createElement('div');
            newMessage.className = 'message user';
            newMessage.innerText = message;

            const messageTime = document.createElement('div');
            messageTime.className = 'message-time';
            messageTime.innerText = time;

            newMessageContainer.appendChild(newMessage);
            newMessageContainer.appendChild(messageTime);
            messagesContainer.appendChild(newMessageContainer);

            document.getElementById('chatInput').value = ''; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
            messagesContainer.scrollTop = messagesContainer.scrollHeight; // ìŠ¤í¬ë¡¤ì„ ì•„ë˜ë¡œ ìë™ ì´ë™
            // ì—¬ê¸°ì— ë©”ì‹œì§€ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ëŠ” ë¡œì§ ì¶”ê°€
        }
    }

    // Enter í‚¤ ì…ë ¥ ì‹œ ë©”ì‹œì§€ ì „ì†¡
    document.getElementById('chatInput').addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
            sendMessage();
        }
    });

    // ì²¨ë¶€íŒŒì¼ ë²„íŠ¼ í´ë¦­ ì‹œ íŒŒì¼ ì²¨ë¶€ì°½ ì—´ê¸°
    document.getElementById('attachButton').addEventListener('click', function() {
        document.getElementById('fileInput').click();
    });
</script>
</body>
</html>
